# Stage 2: Extended Configuration for Phicomm K2P
# 包含所有阶段1的基础包 + 扩展功能

# ==================== 基础配置（与阶段1相同） ====================
CONFIG_TARGET_ramips=y
CONFIG_TARGET_ramips_mt7621=y
CONFIG_TARGET_ramips_mt7621_DEVICE_phicomm_k2p=y
CONFIG_TARGET_ROOTFS_SQUASHFS=y
CONFIG_TARGET_ROOTFS_PARTSIZE=16

# ==================== 核心系统包（必需） ====================
CONFIG_PACKAGE_busybox=y
CONFIG_PACKAGE_dropbear=y
CONFIG_PACKAGE_firewall=y
CONFIG_PACKAGE_uci=y
CONFIG_PACKAGE_opkg=y
CONFIG_PACKAGE_procd=y
CONFIG_PACKAGE_netifd=y
CONFIG_PACKAGE_swconfig=y
CONFIG_PACKAGE_uboot-envtools=y
CONFIG_PACKAGE_wpad-basic=y
CONFIG_PACKAGE_default-settings=y

# ==================== 网络基础 ====================
CONFIG_PACKAGE_iw=y
CONFIG_PACKAGE_iwinfo=y
CONFIG_PACKAGE_dnsmasq=y
CONFIG_PACKAGE_odhcpd-ipv6only=y
CONFIG_PACKAGE_odhcp6c=y
CONFIG_PACKAGE_fstools=y
CONFIG_PACKAGE_mtd=y
CONFIG_PACKAGE_logd=y
CONFIG_PACKAGE_uclient-fetch=y

# ==================== 无线驱动 ====================
CONFIG_PACKAGE_kmod-mt7603=y
CONFIG_PACKAGE_kmod-mt7615e=y
CONFIG_PACKAGE_kmod-mt7621=y
CONFIG_PACKAGE_kmod-ppp=y
CONFIG_PACKAGE_kmod-pppoe=y
CONFIG_PACKAGE_kmod-pppox=y

# ==================== 第二阶段新增：Web管理界面 ====================
CONFIG_PACKAGE_luci=y
CONFIG_PACKAGE_luci-ssl=y
CONFIG_PACKAGE_luci-compat=y
CONFIG_PACKAGE_luci-base=y

# LuCI主题
CONFIG_PACKAGE_luci-theme-bootstrap=y

# LuCI应用模块
CONFIG_PACKAGE_luci-app-firewall=y
CONFIG_PACKAGE_luci-app-opkg=y
CONFIG_PACKAGE_luci-app-system=y
CONFIG_PACKAGE_luci-app-commands=y
CONFIG_PACKAGE_luci-app-filetransfer=y
CONFIG_PACKAGE_luci-app-advanced-reboot=y
CONFIG_PACKAGE_luci-app-upnp=y

# ==================== 第二阶段新增：系统工具 ====================
# 文本编辑器
CONFIG_PACKAGE_nano=y
# CONFIG_PACKAGE_vim=y  # 可选，vim较大

# 进程监控
CONFIG_PACKAGE_htop=y

# 网络诊断工具
CONFIG_PACKAGE_curl=y
CONFIG_PACKAGE_wget=y
CONFIG_PACKAGE_iperf3=y
CONFIG_PACKAGE_tcpdump=y
CONFIG_PACKAGE_ping=y
CONFIG_PACKAGE_traceroute=y
CONFIG_PACKAGE_mtr=y
CONFIG_PACKAGE_arp-scan=y

# 系统信息
CONFIG_PACKAGE_lm-sensors=y
CONFIG_PACKAGE_smartmontools=y

# ==================== 第二阶段新增：网络服务 ====================
# SSH增强
CONFIG_PACKAGE_openssh-sftp-server=y
CONFIG_PACKAGE_openssh-client=y

# 文件传输
CONFIG_PACKAGE_vsftpd=y
CONFIG_PACKAGE_vsftpd-tls=y

# 时间同步
CONFIG_PACKAGE_ntpd=y
CONFIG_PACKAGE_ntpdate=y
CONFIG_PACKAGE_ntp-utils=y

# 动态DNS
CONFIG_PACKAGE_ddns-scripts=y
CONFIG_PACKAGE_ddns-scripts-cloudflare=y
CONFIG_PACKAGE_ddns-scripts-services=y

# ==================== 第二阶段新增：网络优化 ====================
# QoS和流量控制
CONFIG_PACKAGE_qos-scripts=y
CONFIG_PACKAGE_luci-app-qos=y

# 带宽监控
CONFIG_PACKAGE_bwm-ng=y
CONFIG_PACKAGE_vnstat=y
CONFIG_PACKAGE_vnstati=y
CONFIG_PACKAGE_luci-app-statistics=y

# 网络唤醒
CONFIG_PACKAGE_wol=y
CONFIG_PACKAGE_etherwake=y

# ==================== 第二阶段新增：实用工具 ====================
# 压缩工具
CONFIG_PACKAGE_unrar=y
CONFIG_PACKAGE_unzip=y
CONFIG_PACKAGE_zip=y

# 文件管理
CONFIG_PACKAGE_file=y
CONFIG_PACKAGE_findutils=y
CONFIG_PACKAGE_grep=y

# 终端增强
CONFIG_PACKAGE_bash=y
CONFIG_PACKAGE_zsh=y  # 可选
CONFIG_PACKAGE_tmux=y

# ==================== 第二阶段新增：内核模块 ====================
# USB支持（如果有USB版本）
# CONFIG_PACKAGE_kmod-usb-core=y
# CONFIG_PACKAGE_kmod-usb2=y
# CONFIG_PACKAGE_kmod-usb-storage=y

# 文件系统
CONFIG_PACKAGE_kmod-fs-ext4=y
CONFIG_PACKAGE_kmod-fs-ntfs=y
CONFIG_PACKAGE_kmod-fs-vfat=y

# ==================== 明确排除的包（节省空间） ====================
# 禁用完整版wpad（使用basic版）
# CONFIG_PACKAGE_wpad is not set
# CONFIG_PACKAGE_wpad-wolfssl is not set

# 禁用完整版dnsmasq
# CONFIG_PACKAGE_dnsmasq-full is not set

# 禁用不需要的VPN模块
# CONFIG_PACKAGE_openvpn-openssl is not set
# CONFIG_PACKAGE_wireguard-tools is not set

# 禁用大型服务
# CONFIG_PACKAGE_samba4-server is not set
# CONFIG_PACKAGE_transmission-daemon is not set

# ==================== 固件大小检查 ====================
# 总固件大小应小于16MB
# 如果编译失败提示空间不足，可以按优先级禁用以下包：
# 1. 首先禁用：zsh, vim, luci-app-advanced-reboot
# 2. 其次禁用：tcpdump, mtr, arp-scan
# 3. 最后考虑：iperf3, lm-sensors, smartmontools
